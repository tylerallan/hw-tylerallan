---
title: "Final Project"
author: "Tyler Allan"
date: "3/8/2021"
output: 
          html_document: default
          github_document: default
---

## Introduction

### Research Question

One of the many ways that individuals differ is through the tasks and activities they prefer to do. The study of vocational interests arose in Industrial-Organizational psychology to research what tasks are unique to a job and how individuals differ in the types of work related tasks they prefer to perform. Part of the research done on this topic has focused on the heritability of career interests. Previous research established a moderate genetic component to career interests which indicates that parent's can pass their interests on to their children through their genes. However, genes are not the only influence that parents have in the development of their children's career interests. Parents also shape the environment that children are raised in and provide their children with a first look into the working world. By viewing their parent's successes and failures at specific job tasks or through conversations their parents have about their work, children develop their own viewpoint of how they would perform on those jobs. This project is hoping to show the relationship between parent occupations and children career interest which develops through these genetic and environmental factors. 

## The dataset

This dataset contains information about mono and dyzygotic twins and their parents occupations. The twins in this study completed two measures of vocational interest, the Personal Globe Inventory (pgi) and the   to establish their interest profiles. Parent occupations were assessed at the time of the child's birth and were coded into ONET occupation codes. Regression analysis will be done to predict the child's interest scores based on their parent's occupation. Children's interest scores are in their raw form and will be combined into an average for each participant which will be used as the criterion variable in the regression analysis. The ONET occupation codes will be trimmed to just represent the broader job family rather than the specific job titles and these will be used as predictors in a regression equation. 

First we need to load the required packages and read in the data.

```{r}
library(tidyverse)
library(readxl)
library(correlation)

thesisdata <- read_xlsx(here::here("Data", "PAINT_Study_Wave_1_3_2021-3-8.xlsx"))
```


First we need to trim down the dataset so that it only includes the interest items from the two interest measures (pgi and pci) and the occupation codes for the mother and father.
```{r}
trimdata <- thesisdata %>%
  select(`Family Number...30`, Childnumber...37, pgi_01_I:pci_42, PCI_Rea, PCI_Inv, PCI_Art, PCI_Soc, PCI_Ent, PCI_Con, MONET, FONET_J, -`Current Training`, - `Current Job`, -`Percentage Independent`) %>% 
  slice(417:755)

```

Now that the data has been read in, we need to clean the variables so they can be used in our analysis.

```{r}
#create mean score of liking and competence variables for pgi
trimdata$`Family Number...30` <- factor(trimdata$`Family Number...30`)
trimdata$Childnumber...37 <- factor(trimdata$Childnumber...37)


avgdata <- trimdata %>% 
  rowwise %>% 
  mutate(pgi_avg = mean(c_across(pgi_01_I:pgi_40_I), na.rm = TRUE),
         pci_avg = mean(c_across(pci_01:pci_42), na.rm = TRUE))

avgdata
#take off the `-numbers` from the occupation codes

trimdata$MONET <- factor(trimdata$MONET)
c <-  c("43-6014.00", "39-9011.00", "29-1122.00")
gsub(c("-6014.00", "-9011.00", "29-1122.00"), "", c)

```

Creating a table to show each the mean, standard deviation, minimum average score, maximum average score, and the correlation between the two average scores on the inventories for both interest inventories grouped by the child's identification number. 

```{r}
avgdata %>%
  select(pgi_avg, pci_avg) %>% 
  summarize(across(c(pgi_avg:pci_avg),
            list(mu = ~mean(.x, na.rm = TRUE),
                 sd = ~sd(.x, na.rm = TRUE),
                 min = ~min(.x),
                 max = ~max(.x)),
                 r = cor(pgi_avg, pci_avg, use = "pairwise"),
            ),
  .groups = "drop")


#For some reason that I cannot figure out, the output of this code is a table that repeats each individual data point as the output for each of these transformations rather than doing the computations for the two columns. 

#Trying to put together a summary table by hand with the correct values                
pgi_mean <- mean(avgdata$pgi_avg, na.rm = TRUE)
pgi_sd <- sd(avgdata$pgi_avg, na.rm = TRUE)  
pci_mean <- mean(avgdata$pci_avg, na.rm = TRUE)
pci_sd <- sd(avgdata$pci_avg, na.rm = TRUE)
r <- cor(avgdata$pgi_avg, avgdata$pci_avg, use = "pairwise")

SummaryTable <- as.data.frame(c(pgi_mean, pgi_sd, pci_mean, pci_sd, r), row.names = c("PGI_Mean", "PGI_SD", "PCI_Mean", "PCI_SD", "Correlation"), col.names = "Score")
colnames(SummaryTable) <- c("Score")
as_tibble(SummaryTable)
rownames(SummaryTable) <- c("PGI_Mean", "PGI_SD", "PCI_Mean", "PCI_SD", "Correlation")

SummaryTable
```


Run the regression predicting interest score based on parent occupation

```{r}
#lm(~)

```

Create a scatterplot to show the relationship between parent occupation category and child interest scores.

```{r}


```



```{r}
practice_plot <- thesisdata %>% 
  ggplot()+
  aes(y = pgi_01_I,
      x = pgi_01_c) +
  geom_point()

practice_plot

ggsave(here::here("Output", "Figures", "practice_plot.pdf"))
ggsave(here::here("Output", "Figures", "practice_plot.tiff"))
ggsave(here::here("Output", "Figures", "practice_plot.png"))
```